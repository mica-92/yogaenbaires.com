{{ with .Site.GetPage "/projects" }}
<div class="section" id="el_sendero">
    <!-- Begin Blog container -->
    <div class="container">
        {{ if .Site.Params.home.showLatest | default true }}
        

        {{ partial "images/caminodelyogui" }}
        <br>
        {{partial "legend-map.html" .}}

        <div class="container">
            <br><hr><br><br>
        </div>

        {{ partial "images/paradas" }}

        <br>

        {{ range first 1 .Pages.ByPublishDate.Reverse }}
        <div class="summary">

            {{partial "images/laultimaestacion" .}}

            
            <h3 class="title is-3 latest-post-title">
                <a href="{{ .Permalink }}">
                    #{{ .Params.id | markdownify }} - {{ .Params.title | markdownify }}
                </a></h3>
            
            {{partial "post-taxonomy.html" .}}
            
            {{ if .Params.descripcion }}
            <div class="post-description" style="margin-top:0.8rem !important;">
 
                {{ .Params.descripcion | markdownify }}
            </div>

            {{ end }}
        </div>
        {{ end }}
        {{ end }}
    </div>


    {{ partial "home/destacados2.html" . }}

    {{ if .Site.Params.home.showAllPosts }}
    <div class="section" id="all-posts">
        <div class="container">

            {{partial "images/recorrido" .}}

                    <!-- Add this search bar section -->
        <div class="search-container" style="margin: 2rem auto; max-width: 600px;">
            <input type="text" id="postSearch" placeholder="Buscar publicaciones..." 
                   style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            <div id="searchResults" style="margin-top: 1rem;"></div>
        </div>

            {{ partialCached "projects/li.html" . }}
        </div>
    </div>

    {{ end }}
</div>

<!-- End Blog container -->
{{ partial "top-icon.html" . }}

<!-- End Blog section -->
<div class="container">
    <hr>
</div>
{{ end }}

<script>
    function enableMapInteractivity(overlay) {
        const iframe = overlay.previousElementSibling;
        iframe.style.pointerEvents = 'auto';
        overlay.style.display = 'none';
        
        setTimeout(() => {
            iframe.style.pointerEvents = 'none';
            overlay.style.display = 'block';
        }, 30000);
    }

    document.addEventListener('DOMContentLoaded', function() {
        const initSlider = (sliderWrapper) => {
            const imageList = sliderWrapper.querySelector(".image-list");
            const slideButtons = sliderWrapper.querySelectorAll(".slide-button");
            const sliderScrollbar = sliderWrapper.parentElement.querySelector(".slider-scrollbar");
            const scrollbarThumb = sliderScrollbar.querySelector(".scrollbar-thumb");
            const maxScrollLeft = imageList.scrollWidth - imageList.clientWidth;
            
            scrollbarThumb.addEventListener("mousedown", (e) => {
                const startX = e.clientX;
                const thumbPosition = scrollbarThumb.offsetLeft;
                const maxThumbPosition = sliderScrollbar.getBoundingClientRect().width - scrollbarThumb.offsetWidth;
                
                const handleMouseMove = (e) => {
                    const deltaX = e.clientX - startX;
                    const newThumbPosition = thumbPosition + deltaX;
                    const boundedPosition = Math.max(0, Math.min(maxThumbPosition, newThumbPosition));
                    const scrollPosition = (boundedPosition / maxThumbPosition) * maxScrollLeft;
                    
                    scrollbarThumb.style.left = `${boundedPosition}px`;
                    imageList.scrollLeft = scrollPosition;
                }
                
                const handleMouseUp = () => {
                    document.removeEventListener("mousemove", handleMouseMove);
                    document.removeEventListener("mouseup", handleMouseUp);
                }
                
                document.addEventListener("mousemove", handleMouseMove);
                document.addEventListener("mouseup", handleMouseUp);
            });
            
            slideButtons.forEach(button => {
                button.addEventListener("click", () => {
                    const direction = button.id === "prev-slide" ? -1 : 1;
                    const scrollAmount = imageList.clientWidth * direction;
                    imageList.scrollBy({ left: scrollAmount, behavior: "smooth" });
                });
            });
            
            const handleSlideButtons = () => {
                slideButtons[0].style.display = imageList.scrollLeft <= 0 ? "none" : "flex";
                slideButtons[1].style.display = imageList.scrollLeft >= maxScrollLeft ? "none" : "flex";
            }
            
            const updateScrollThumbPosition = () => {
                const scrollPosition = imageList.scrollLeft;
                const thumbPosition = (scrollPosition / maxScrollLeft) * (sliderScrollbar.clientWidth - scrollbarThumb.offsetWidth);
                scrollbarThumb.style.left = `${thumbPosition}px`;
            }
            
            imageList.addEventListener("scroll", () => {
                updateScrollThumbPosition();
                handleSlideButtons();
            });
        }
        
        document.querySelectorAll('.slider-wrapper').forEach(slider => {
            initSlider(slider);
        });
    });



    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('postSearch');
        const searchResults = document.getElementById('searchResults');
        
        if (searchInput && searchResults) {
            searchInput.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                
                if (query.length < 2) {
                    searchResults.innerHTML = '';
                    return;
                }
                
                // Get all post items - adjust selector based on your projects/li.html structure
                const posts = document.querySelectorAll('.post-item, .project-item, .summary'); 
                let resultsHTML = '';
                let matchCount = 0;
                
                posts.forEach(post => {
                    const title = post.querySelector('h2, h3, h4')?.textContent.toLowerCase() || '';
                    const content = post.textContent.toLowerCase();
                    
                    if (title.includes(query) || content.includes(query)) {
                        const link = post.querySelector('a')?.href || '#';
                        const titleText = post.querySelector('h2, h3, h4')?.textContent || 'Sin t√≠tulo';
                        
                        resultsHTML += `
                            <div class="search-result-item" style="padding: 0.5rem; border-bottom: 1px solid #eee;">
                                <a href="${link}" style="color: inherit; text-decoration: none;">
                                    ${titleText}
                                </a>
                            </div>
                        `;
                        matchCount++;
                    }
                });
                
                if (matchCount > 0) {
                    searchResults.innerHTML = resultsHTML;
                } else {
                    searchResults.innerHTML = '<p style="padding: 0.5rem;">No se encontraron resultados</p>';
                }
            });
        }
        
        // Your existing slider initialization code
        document.querySelectorAll('.slider-wrapper').forEach(slider => {
            initSlider(slider);
        });
    });

</script>